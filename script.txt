ALIGN CHROMOSOME

python3 main.py align-chr \
"/Users/zionayokunnu/Documents/Bibionidae/fasta/Dioctria_linearis.fna" \
"/Users/zionayokunnu/Documents/Bibionidae/fasta/Dioctria_rufipes.fna" \
-o "/Users/zionayokunnu/Documents/Giq/comparison_output/" \
--busco-files \
"/Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv" \
"/Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv"


BUILD PROFILE

python3 main.py build-profile \
"/Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv" \
"/Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv" \
-o comparison_output/ \
--bin-size 200 \
--chr-map "/Users/zionayokunnu/Documents/giq/comparison_output/chromosome_mappings.json"



QUERY GENOME ON PROFILE
python3 main.py analyze-query \
/Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv \
/Users/zionayokunnu/Documents/Giq/comparison_output/hybrid_profile.json \
-o /Users/zionayokunnu/Documents/Giq/comparison_output/ \
--bin-size 200 --threshold 0.7


PAIRWISE GENOME MOVEMENT
python3 main.py pairwise-comparison \
  /Users/zionayokunnu/Documents/Giq/compare/Dioctria_linearis_100.tsv \
  /Users/zionayokunnu/Documents/Giq/compare/Dioctria_rufipes_100.tsv \
  -o /Users/zionayokunnu/Documents/Giq/comparison_output/ \
  --iterations 200 --mode rank --shared-genes 200
  --flexible 100000

python3 main.py pairwise-comparison \
  /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv \
  /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv \
  -o /Users/zionayokunnu/Documents/Giq/comparison_output/ \
  --iterations 100 --mode rank






to implement:

def quick_pattern_check(pattern):
    """Fast rejection based on actual flip pattern requirements"""
    if len(pattern) < 2:
        return False
    
    # Type 1: Length 2 - need mixed signs
    if len(pattern) == 2:
        return (pattern[0] > 0 and pattern[1] < 0) or (pattern[0] < 0 and pattern[1] > 0)
    
    # Type 2+: Length >= 3 - need fulcrum AND mixed signs
    has_zero = 0 in pattern
    has_positive = any(m > 0 for m in pattern)
    has_negative = any(m < 0 for m in pattern)
    
    return has_zero and has_positive and has_negative










AGORA's

Extract bz gene list from buscos 


# Bibio marci
awk -F'\t' -v OFS='\t' -v sp="Bibio_marci" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/bibio_marci.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/genes.Bibio_marci.list.bz2

# Plecia longiforceps
awk -F'\t' -v OFS='\t' -v sp="Plecia_longiforceps" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/plecia_longiforceps.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/genes.Plecia_longiforceps.list.bz2

# Dilophus febrilis
awk -F'\t' -v OFS='\t' -v sp="Dilophus_febrilis" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/dilophus_febrilis.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/genes.Dilophus_febrilis.list.bz2


# Dioctria linearis
awk -F'\t' -v OFS='\t' -v sp="Dioctria_linearis" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/genes.Dioctria_linearis.list.bz2




# Dioctria rufipes
awk -F'\t' -v OFS='\t' -v sp="Dioctria_rufipes" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/genes.Dioctria_rufipes.list.bz2


# Leptarthrus brevirostris
awk -F'\t' -v OFS='\t' -v sp="Leptarthrus_brevirostris" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Leptarthrus_brevirostris.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/genes.Leptarthrus_brevirostris.list.bz2

 Create orthology groups in 
cd /Users/zionayokunnu/Documents/giq/extracted

Extract BUSCO IDs from each species
awk -F'\t' '$1!~/^#/ && $2=="Complete"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/bibio_marci.tsv > /Users/zionayokunnu/Documents/giq/extracted/ids.Bibio
awk -F'\t' '$1!~/^#/ && $2=="Complete"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/plecia_longiforceps.tsv > /Users/zionayokunnu/Documents/giq/extracted/ids.Plecia  
awk -F'\t' '$1!~/^#/ && $2=="Complete"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/dilophus_febrilis.tsv > /Users/zionayokunnu/Documents/giq/extracted/ids.Dilophus

awk -F'\t' '$1!~/^#/ && $2=="Complete"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/giq/extracted/ids.Dioctria_lin
awk -F'\t' '$1!~/^#/ && $2=="Complete"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/giq/extracted/ids.Dioctria_ruf
awk -F'\t' '$1!~/^#/ && $2=="Complete"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/giq/extracted/ids.Leptarthrus



Check- Find common BUSCO IDs across all 3(no. of Genomes) species / be in extracted/
cat ids.Dioctria_lin ids.Dioctria_ruf ids.Leptarthrus | sort | uniq -c | awk '$1==3{print $2}' > /Users/zionayokunnu/Documents/giq/extracted/busco_ids_all.txt

cat ids.Dioctria_lin ids.Dioctria_ruf | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/giq/extracted/busco_ids_all.txt


cat ids.Bibio ids.Dilophus ids.Plecia | sort | uniq -c | awk '$1==3{print $2}' > /Users/zionayokunnu/Documents/giq/extracted/busco_ids_bibio_trio.txt

Check how many common genes we have
wc -l busco_ids_all.txt


wc -l busco_ids_bibio_trio.txt

Create orthology groups file
awk '{printf "%s\tBibio_marci|%s\tPlecia_longiforceps|%s\tDilophus_febrilis|%s\n",$1,$1,$1,$1}' \
  busco_ids_bibio_trio.txt | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/orthologyGroups.bibio_trio.list.bz2


awk '{printf "%s\tDioctria_linearis|%s\tDioctria_rufipes|%s\tLeptarthrus_brevirostris|%s\n",$1,$1,$1,$1}' \
  busco_ids_all.txt | bzip2 > /Users/zionayokunnu/Documents/giq/extracted/orthologyGroups.all.list.bz2



awk '{printf "%s\tDioctria_linearis|%s\tDioctria_linearis2|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/Giq/TestingAgora/busco_ids_all.txt | bzip2 > /Users/zionayokunnu/Documents/giq/testingAgora/orthologyGroups.504100.00.list.bz2


#symbolic links for ancestral nodes
ln -sf orthologyGroups.bibio_trio.list.bz2 orthologyGroups.552100.00.list.bz2
ln -sf orthologyGroups.bibio_trio.list.bz2 orthologyGroups.553100.00.list.bz2

ln -sf orthologyGroups.all.list.bz2 orthologyGroups.504100.00.list.bz2
ln -sf orthologyGroups.all.list.bz2 orthologyGroups.503100.00.list.bz2


AGORA reformatting (this should work now with proper gene files)

1. 
python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/bibio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/extracted/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/extracted/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/giq/reformatted/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/giq/reformatted/genes.%s.list.bz2


python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/extracted/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/extracted/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/giq/reformatted/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/giq/reformatted/genes.%s.list.bz2

python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/testingAgora/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/testingAgora/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/giq/testingAgora/reformatted_ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/giq/testingAgora/reformatted_genes.%s.list.bz2




2.

TARGET=552100.00
TARGET=553100.00
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/giq/reformatted/genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/reformatted/ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/giq/agora_results/pairs.%s.list.bz2 


TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/giq/testingAgora/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/testingAgora/reformatted_ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/giq/testingAgora/pairs.%s.list.bz2 




TARGET=553100.00
TARGET=552100.00
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/giq/agora_results/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/reformatted/ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/giq/agora_results/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/giq/agora_results/graph.%s.txt.bz2 \
  -minimalWeight=1 


python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/giq/testingAgora/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/testingAgora/reformatted_ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/giq/testingAgora/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/giq/testingAgora/graph.%s.txt.bz2 \
  -minimalWeight=1 



UNIQUE
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-scaffolds.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/giq/agora_results/blocks.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/giq/agora_results/scaffolded_blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/giq/agora_results/scaffold_graph.%s.txt.bz2 \
  -genesFiles=/Users/zionayokunnu/Documents/giq/reformatted/genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/reformatted/ancGenes.%s.list.bz2 \
  -anchorSize=6


  
TARGET=553100.00
TARGET=552100.00
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/giq/agora_results/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/reformatted/ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/giq/agora_results/ancGenome.%s.list.bz2 



TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/giq/testingAgora/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/giq/testingAgora/reformatted_ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/giq/testingAgora/ancGenome.%s.list.bz2 




#compare


python3 /Users/zionayokunnu/Documents/Agora/src/misc.compareGenomes.py \
  /Users/zionayokunnu/Documents/giq/reformatted/genes.Dioctria_linearis.list.bz2 \
  /Users/zionayokunnu/Documents/giq/agora_results/ancGenome.504100.00.list.bz2 \
  /Users/zionayokunnu/Documents/giq/reformatted/ancGenes.504100.00.list.bz2 \
  -mode=printOrthologuesCount





SpeciesOptimal Bin Size (bp)
Dioctria linearis 288,000
Dioctria rufipes 288,000
Bibio marci 73,000
Dilophus febrilis 64,000
Plecia longiforceps 150,000
Leptarthrus brevirostris 177,000











































CHROMOSOME-AWARE AGORA


python3 /Users/zionayokunnu/Documents/Agora/src/chromosome_aware_extension/detect_chromosome_homology.py \
  --busco-files /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv \
  /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv \
  --output-dir /Users/zionayokunnu/Documents/giq/homology_results/ \
  --threshold 300


EXTRACT GENES FROM SPECIES

# Dioctria linearis
awk -F'\t' -v OFS='\t' -v sp="Dioctria_linearis" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_linearis.list.bz2


# Dioctria rufipes
awk -F'\t' -v OFS='\t' -v sp="Dioctria_rufipes" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_rufipes.list.bz2



# Leptarthrus brevirostris
awk -F'\t' -v OFS='\t' -v sp="Leptarthrus_brevirostris" '
  $1!~/^#/ && $2=="Complete" {
    b=$4; e=$5;
    if(b>e){temp=b; b=e; e=temp}
    strand=($6=="+"?1:($6=="-"?-1:1))
    print $3,b,e,strand,sp "|" $1
  }' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Leptarthrus_brevirostris.tsv | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/genes.Leptarthrus_brevirostris.list.bz2


EXTRACT GENES FROM SPECIES CHROMOSOMES INTO GROUP FOLDERS

# Group 001: Extract from OZ005744.1 and OZ002744.1, OZ002745.1

# Extract Dioctria_linearis genes from OZ005744.1
bzcat /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_linearis.list.bz2 | awk '$1=="OZ005744.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_001/genes.Dioctria_linearis.list.bz2

# Extract Dioctria_rufipes genes from OZ002744.1
bzcat /Users/zionayokunnu/Documents/Giq/homology_results/genes.Dioctria_rufipes.list.bz2 | awk '$1=="OZ002744.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_001/genes.Dioctria_rufipes.list.bz2


# Extract Dioctria_rufipes genes from OZ002745.1
bzcat /Users/zionayokunnu/Documents/Giq/homology_results/genes.Dioctria_rufipes.list.bz2 | awk '$1=="OZ002745.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_001/genes.Dioctria_rufipes.list.bz2

bzcat /Users/zionayokunnu/Documents/giq/testingAgora/genes.Dioctria_linearis.list.bz2 | awk '$1=="OZ005744.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/testingAgora/group_001/genes.Dioctria_linearis2.list.bz2


# Group 002: Extract from OZ005740.1 and OZ002740.1

# Extract Dioctria_linearis genes from OZ005744.1
bzcat /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_linearis.list.bz2 | awk '$1=="OZ005740.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_002/genes.Dioctria_linearis.list.bz2

# Extract Dioctria_rufipes genes from OZ002744.1
bzcat /Users/zionayokunnu/Documents/Giq/homology_results/genes.Dioctria_rufipes.list.bz2 | awk '$1=="OZ002740.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_002/genes.Dioctria_rufipes.list.bz2


# Group 003: Extract from OZ005740.1 and OZ002741.1

# Extract Dioctria_linearis genes from OZ005740.1
bzcat /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_linearis.list.bz2 | awk '$1=="OZ005741.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_003/genes.Dioctria_linearis.list.bz2

# Extract Dioctria_rufipes genes from OZ002741.1
bzcat /Users/zionayokunnu/Documents/Giq/homology_results/genes.Dioctria_rufipes.list.bz2 | awk '$1=="OZ002741.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_003/genes.Dioctria_rufipes.list.bz2


# Group 004: Extract from OZ005742.1 and OZ002742.1

# Extract Dioctria_linearis genes from OZ005742.1
bzcat /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_linearis.list.bz2 | awk '$1=="OZ005742.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_004/genes.Dioctria_linearis.list.bz2

# Extract Dioctria_rufipes genes from OZ002742.1
bzcat /Users/zionayokunnu/Documents/Giq/homology_results/genes.Dioctria_rufipes.list.bz2 | awk '$1=="OZ002742.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_004/genes.Dioctria_rufipes.list.bz2


# Group 005: Extract from OZ005743.1 and OZ002743.1

# Extract Dioctria_linearis genes from OZ005743.1
bzcat /Users/zionayokunnu/Documents/giq/homology_results/genes.Dioctria_linearis.list.bz2 | awk '$1=="OZ005743.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_005/genes.Dioctria_linearis.list.bz2

# Extract Dioctria_rufipes genes from OZ002743.1
bzcat /Users/zionayokunnu/Documents/Giq/homology_results/genes.Dioctria_rufipes.list.bz2 | awk '$1=="OZ002743.1"' | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/group_005/genes.Dioctria_rufipes.list.bz2



CREATE ORTHOLOGY GROUPS

python3 /Users/zionayokunnu/Documents/Agora/src/chromosome_aware_extension/create_orthology_groups.py \
    --homology-file /Users/zionayokunnu/Documents/giq/homology_results/chromosome_groups.txt \
    --busco-files /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv \
  /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv \
    --species-names Dioctria_linearis Dioctria_rufipes \
    --output-dir /Users/zionayokunnu/Documents/giq/homology_results/orthology_groups/




MANUAL ORTHOLOGY GROUPS
# Extract from Dioctria_linearis chromosome OZ005744.1
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ005743.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/Giq/TestingAgora/group_005/ids.group5_lin


awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ005744.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_001/ids.group1_lin
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ005740.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_002/ids.group2_lin
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ005741.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_003/ids.group3_lin
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ005742.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_004/ids.group4_lin
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ005743.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_linearis.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_005/ids.group5_lin

awk -F'\t' '$1!~/^#/ && $2=="Complete" && ($3=="OZ002744.1" || $3=="OZ002745.1"){print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_001/ids.group1_ruf
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ002740.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_002/ids.group2_ruf
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ002741.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_003/ids.group3_ruf
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ002742.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_004/ids.group4_ruf
awk -F'\t' '$1!~/^#/ && $2=="Complete" && $3=="OZ002743.1"{print $1}' /Users/zionayokunnu/Documents/Bibionidae/busco-tables/Dioctria_rufipes.tsv > /Users/zionayokunnu/Documents/Giq/homology_results/group_005/ids.group5_ruf



#Find common Buscos
cat /Users/zionayokunnu/Documents/Giq/TestingAgora/group_001/ids.group1_lin \
/Users/zionayokunnu/Documents/Giq/TestingAgora/group_001/ids.group1_lin | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/Giq/TestingAgora/group_005/busco_ids_group1.txt


cat /Users/zionayokunnu/Documents/Giq/homology_results/group_001/ids.group1_lin \
/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ids.group1_ruf | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/Giq/homology_results/group_001/busco_ids_group1.txt
cat /Users/zionayokunnu/Documents/Giq/homology_results/group_002/ids.group2_lin \
/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ids.group2_ruf | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/Giq/homology_results/group_002/busco_ids_group2.txt
cat /Users/zionayokunnu/Documents/Giq/homology_results/group_003/ids.group3_lin \
/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ids.group3_ruf | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/Giq/homology_results/group_003/busco_ids_group3.txt
cat /Users/zionayokunnu/Documents/Giq/homology_results/group_004/ids.group4_lin \
/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ids.group4_ruf | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/Giq/homology_results/group_004/busco_ids_group4.txt
cat /Users/zionayokunnu/Documents/Giq/homology_results/group_005/ids.group5_lin \
/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ids.group5_ruf | sort | uniq -c | awk '$1==2{print $2}' > /Users/zionayokunnu/Documents/Giq/homology_results/group_005/busco_ids_group5.txt


#Create orthology file
awk '{printf "%s\tDioctria_linearis|%s\tDioctria_linearis|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/giq/testingAgora/group_005/busco_ids_*.txt | bzip2 > /Users/zionayokunnu/Documents/giq/testingAgora/group_005/orthologyGroups.504100.00.list.bz2


awk '{printf "%s\tDioctria_linearis|%s\tDioctria_rufipes|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/giq/homology_results/group_001/busco_ids_*.txt | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/group_001/orthologyGroups.504100.00.list.bz2
awk '{printf "%s\tDioctria_linearis|%s\tDioctria_rufipes|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/giq/homology_results/group_002/busco_ids_*.txt | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/group_002/orthologyGroups.504100.00.list.bz2
awk '{printf "%s\tDioctria_linearis|%s\tDioctria_rufipes|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/giq/homology_results/group_003/busco_ids_*.txt | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/group_003/orthologyGroups.504100.00.list.bz2
awk '{printf "%s\tDioctria_linearis|%s\tDioctria_rufipes|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/giq/homology_results/group_004/busco_ids_*.txt | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/group_004/orthologyGroups.504100.00.list.bz2
awk '{printf "%s\tDioctria_linearis|%s\tDioctria_rufipes|%s\n",$1,$1,$1,$1}' \
  /Users/zionayokunnu/Documents/giq/homology_results/group_005/busco_ids_*.txt | bzip2 > /Users/zionayokunnu/Documents/giq/homology_results/group_005/orthologyGroups.504100.00.list.bz2



COPY EACH GROUP'S ORTHOLOGS INTO GROUPS' FOLDER
cp /Users/zionayokunnu/Documents/giq/homology_results/orthology_groups/orthologyGroups.group_001.list.bz2 \
   /Users/zionayokunnu/Documents/giq/homology_results/group_001/orthologyGroups.504100.00.list.bz2

cp /Users/zionayokunnu/Documents/giq/homology_results/orthology_groups/orthologyGroups.group_002.list.bz2 \
   /Users/zionayokunnu/Documents/giq/homology_results/group_002/orthologyGroups.504100.00.list.bz2

cp /Users/zionayokunnu/Documents/giq/homology_results/orthology_groups/orthologyGroups.group_003.list.bz2 \
   /Users/zionayokunnu/Documents/giq/homology_results/group_003/orthologyGroups.504100.00.list.bz2

cp /Users/zionayokunnu/Documents/giq/homology_results/orthology_groups/orthologyGroups.group_004.list.bz2 \
   /Users/zionayokunnu/Documents/giq/homology_results/group_004/orthologyGroups.504100.00.list.bz2

cp /Users/zionayokunnu/Documents/giq/homology_results/orthology_groups/orthologyGroups.group_005.list.bz2 \
   /Users/zionayokunnu/Documents/giq/homology_results/group_005/orthologyGroups.504100.00.list.bz2




REFORMAT GENE LIST AND ORTHOLOGY LIST FOR EACH GROUP

GROUP1
python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_001/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/reformatted_genes.%s.list.bz2


GROUP2
python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_002/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/reformatted_genes.%s.list.bz2


GROUP3
python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_003/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/reformatted_genes.%s.list.bz2


GROUP4
python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_004/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/reformatted_genes.%s.list.bz2

GROUP5
python3 /Users/zionayokunnu/Documents/Agora/src/ALL.reformatGeneFamilies.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_005/orthologyGroups.%s.list.bz2 \
  -IN.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/genes.%s.list.bz2 \
  -OUT.ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenes.%s.list.bz2 \
  -OUT.genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/reformatted_genes.%s.list.bz2




FIND CONSERVED GENE ADJACENCY PAIRS IN GROUPS

GROUP1
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/pairs.%s.list.bz2

GROUP2
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/pairs.%s.list.bz2

GROUP3
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/pairs.%s.list.bz2

GROUP4
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/pairs.%s.list.bz2

GROUP5
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.pairwise-conservedPairs.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenes.%s.list.bz2 \
  -OUT.pairwise=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/pairs.%s.list.bz2





DENOVO INTEGRATION PER GROUP

GROUP1
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_001/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/graph.%s.txt.bz2 \
  -minimalWeight=1 



GROUP2
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_002/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/graph.%s.txt.bz2 \
  -minimalWeight=1 

  GROUP3
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_003/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/graph.%s.txt.bz2 \
  -minimalWeight=1 

  GROUP4
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_004/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/graph.%s.txt.bz2 \
  -minimalWeight=1 

  GROUP5
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-denovo.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  /Users/zionayokunnu/Documents/Giq/homology_results/group_005/pairs.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenes.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/graph.%s.txt.bz2 \
  -minimalWeight=1 



OPTIONAL SCAFFOLD INTEGRATION PER GROUP
GROUP1
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-scaffolds.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/blocks.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/scaffolded_blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/scaffold_graph.%s.txt.bz2 \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenes.%s.list.bz2 \
  -anchorSize=6



  GROUP2
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-scaffolds.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/blocks.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/scaffolded_blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/scaffold_graph.%s.txt.bz2 \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenes.%s.list.bz2 \
  -anchorSize=6

  GROUP3
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-scaffolds.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/blocks.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/scaffolded_blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/scaffold_graph.%s.txt.bz2 \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenes.%s.list.bz2 \
  -anchorSize=6

  GROUP4
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-scaffolds.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/blocks.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/scaffolded_blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/scaffold_graph.%s.txt.bz2 \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenes.%s.list.bz2 \
  -anchorSize=6

  GROUP5
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/buildSynteny.integr-scaffolds.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/blocks.%s.list.bz2 \
  -OUT.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/scaffolded_blocks.%s.list.bz2 \
  -LOG.ancGraph=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/scaffold_graph.%s.txt.bz2 \
  -genesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/reformatted_genes.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenes.%s.list.bz2 \
  -anchorSize=6
  



CONVERT BLOCKS TO GENES

GROUP1
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenome.%s.list.bz2 


GROUP2
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenome.%s.list.bz2 

GROUP3
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenome.%s.list.bz2 

GROUP4
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenome.%s.list.bz2 

GROUP5
TARGET=504100.00
python3 /Users/zionayokunnu/Documents/Agora/src/convert.ancGenomes.blocks-to-genes.py \
  /Users/zionayokunnu/Documents/Bibionidae/dio_trio.newick $TARGET \
  -IN.ancBlocks=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/blocks.%s.list.bz2 \
  -ancGenesFiles=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenes.%s.list.bz2 \
  -OUT.ancGenomes=/Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenome.%s.list.bz2 




MERGE THE GROUPS INTO A SINGLE GENOME WITH CHROMOSOME LABEL


(bzcat /Users/zionayokunnu/Documents/Giq/homology_results/group_001/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005744.1-OZ002744.1-OZ002745.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/homology_results/group_002/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005740.1-OZ002740.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/homology_results/group_003/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005741.1-OZ002741.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/homology_results/group_004/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005742.1-OZ002742.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/homology_results/group_005/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005743.1-OZ002743.1"}' OFS='\t') | bzip2 > /Users/zionayokunnu/Documents/Giq/homology_results/merged_ancGenome.504100.00.list.bz2




(bzcat /Users/zionayokunnu/Documents/Giq/testingAgora/group_001/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005744.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/testingAgora/group_002/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005740.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/testingAgora/group_003/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005741.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/testingAgora/group_004/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005742.1"}' OFS='\t';
 bzcat /Users/zionayokunnu/Documents/Giq/testingAgora/group_005/ancGenome.*.list.bz2 | awk '{print $0 "\tOZ005743.1"}' OFS='\t') | bzip2 > /Users/zionayokunnu/Documents/Giq/testingAgora/merged_ancGenome.504100.00.list.bz2
